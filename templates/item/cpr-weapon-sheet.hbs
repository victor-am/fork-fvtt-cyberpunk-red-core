{{log "CPR-WEAPON-SHEET.HBS"}}
{{log data}}
<form>
  {{!-- Item Header Navigation --}}
  {{> "systems/cyberpunk-red-core/templates/item/parts/cpr-header.hbs"}}
  {{!-- Item Sheet Navigation --}}
  <div class="nav-container black-bg">
    <nav class="tabs" data-group="primary">
      <a class="navtab center-text bold white-fg" data-tab="description">{{localize "CPR.description"}}</a>
      <a class="navtab center-text bold white-fg" data-tab="details">{{localize "CPR.details"}}</a>
    </nav>
  </div>
  {{!-- Item Sheet Body --}}
  <section class="content">
    {{!-- Inventory Tab --}}
    <div class="tab" data-group="primary" data-tab="description">
      {{> "systems/cyberpunk-red-core/templates/item/parts/cpr-description.hbs"}}
    </div>
    <div class="tab" data-group="primary" data-tab="details">
      {{!-- MARKET PRICE INPUT --}}
      <div>
        {{localize "CPR.price"}}: <input name="data.price.market" class="" type="number" value="{{data.price.market}}">
      </div>
      {{!-- EQUIPPED --}}
      <div>
        <label class="label-text">{{localize "CPR.equipped"}}</label>
        <select name="data.equipped" data-dtype="{{data.equipped}}">
          {{#select data.equipped}}
          {{#each (findConfigObj "equipped") as |equip e|}}
          <option value="{{e}}">{{localize equip}}</option>
          {{/each}}
          {{/select}}
        </select>
      </div>
      {{!-- ROF INPUT --}}
      <div>
        {{localize "CPR.rof"}}: <input name="data.rof" class="" type="number" value="{{data.rof}}">
      </div>
      {{!-- CONCEALABLE CHECKBOX --}}
      <div>
        <label class="label-text">Concealable</label>
        {{#if data.concealable}}
        <a class="item-checkbox" data-target="data.concealable"><i class="far fa-check-circle"></i></a>
        {{else}}
        <a class="item-checkbox" data-target="data.concealable"><i class="far fa-circle"></i></a>
        {{/if}}
      </div>
      {{!-- WEAPON TYPE DROPDOWN --}}
      <div>
        {{localize "CPR.weapon"}} {{localize "CPR.type"}}:
        <select name="data.weaponType" data-dtype="{{data.weaponType}}">
          {{#select data.weaponType}}
          {{#each (findConfigObj "weaponTypeList") as |type t|}}
          <option value="{{t}}">{{localize type}}</option>
          {{/each}}
          {{/select}}
        </select>
      </div>
      {{!-- WEAPON SKILL DROPDOWN --}}
      <div>
        {{localize "CPR.weapon"}} {{localize "CPR.skill"}}:
        <select name="data.weaponSkill" data-dtype="{{data.weaponSkill}}">
          {{#select data.weaponSkill}}
          {{!-- Would be nice if this was sorted, but not sure how to do that. --}}
          {{#each (getProp this.filteredItems 'skill') as |skillOption| }}
          {{#if (listContains "rangedweaponSkills,fightingSkills" skillOption.data.data.category)}}
          <option value="{{skillOption.data.name}}">{{skillOption.data.name}}</option>
          {{/if}}
          {{/each}}
          {{/select}}
        </select>
      </div>
      {{!-- WEAPON QUALITY --}}
      <div>
        {{localize "CPR.weapon"}} {{localize "CPR.quality"}}:
        <select name="data.quality" data-dtype="{{data.quality}}">
          {{#select data.quality}}
          <option value="standard">{{localize "CPR.standard"}}</option>
          <option value="excellent">{{localize "CPR.excellent"}}</option>
          <option value="poor">{{localize "CPR.poor"}}</option>
          {{/select}}
        </select>
      </div>
      {{!-- DAMAGE INPUT --}}
      <div>
        {{localize "CPR.damage"}}: <input name="data.damage" class="" type="text" value="{{data.damage}}">
      </div>
      {{!-- # HANDS REQ INPUT --}}
      <div>
        {{localize "CPR.handsrequired"}}: <input name="data.handsReq" class="" type="number" value="{{data.handsReq}}">
      </div>
      {{!-- IS RANGED CHECKBOX --}}
      <div>
        <label class="label-text">{{localize "CPR.rangedweapon"}}</label>
        {{#if data.isRanged}}
        <a class="item-checkbox" data-target="data.isRanged"><i class="far fa-check-circle"></i></a>
        {{else}}
        <a class="item-checkbox" data-target="data.isRanged"><i class="far fa-circle"></i></a>
        {{/if}}
      </div>
      {{#if data.isRanged}}
      {{!-- # ALT FIRE MODES INPUT --}}
      <div>
        {{localize "CPR.altfiremodes"}}: <input name="data.altFireModes" class="" type="text"
          value="{{data.altFireModes}}">
      </div>
      {{!-- # MAG SIZE INPUT --}}
      <div>
        {{localize "CPR.magazine"}} {{localize "CPR.size"}}: <input name="data.magazine.max" class="" type="number"
          value="{{data.magazine.max}}">
      </div>
      {{!-- BUILD AMMO ALLOWED ARRAY --}}
      <div>
        {{!-- Label for multiselect option, also defines target array--}}
        <label>Configure Compatible Ammo</label>
        <div class="dynamic-list item-multi-select" data-target="data.ammoVariety">
          {{#each (findConfigObj "ammoVariety") as |ammoVariety a|}}
          <div class="row item white-bg black-fg">
            <div class="section flex-start width-half">
              <label>{{localize ammoVariety}}</label>
            </div>
            <div class="section name width-grow">
              {{#if (listContains (getProp ../this.data "ammoVariety") a)}}
              <a class="item-multi-option" data-value={{a}}><i class="far fa-check-circle"></i></a>
              {{else}}
              <a class="item-multi-option" data-value={{a}}><i class="far fa-circle"></i></a>
              {{/if}}
            </div>
          </div>
          {{/each}}
        </div>
      </div>
      {{/if}}
    </div>
  </section>
</form>
{{log "CPR-WEAPON-SHEET.HBS"}}